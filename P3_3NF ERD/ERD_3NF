-- This script was generated by a beta version of the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public."Suppliers"
(
    "SUPPLIER_ID" serial,
    "SPECIALTY" character(15),
    "ACTIVE" character varying(1),
    "Purchase_ID" integer,
    "Orders_ID" integer
);

CREATE TABLE IF NOT EXISTS public."Purchases"
(
    "Purchase_ID" serial,
    "TOTALBOUGHT" numeric(8, 2) NOT NULL,
    "TOTALSOLD" numeric(8, 2) NOT NULL,
    "TOTALREV" numeric(10, 2) NOT NULL,
    "MARGIN" numeric(10, 2) NOT NULL,
    "LASTDELIVERY" date,
    "PRODUCT_ID" integer,
    CONSTRAINT "pk_purchaseID" PRIMARY KEY ("Purchase_ID")
);

CREATE TABLE IF NOT EXISTS public."Products"
(
    "PRODUCT_ID" serial NOT NULL,
    "SUPPLIER_ID" integer NOT NULL,
    "PRODUCT_NAME" character(15) NOT NULL,
    "TYPE" character(10) NOT NULL,
    "STOCKQTY" numeric(4, 2) NOT NULL,
    "NXTDELIVERY" date,
    PRIMARY KEY ("PRODUCT_ID")
);

CREATE TABLE IF NOT EXISTS public."ORDERS"
(
    "Order_ID" serial,
    "STOCKQTY" numeric(4, 2),
    "SUPPLIER_ID" integer,
    "PRODUCT_ID" integer,
    "LASTDELIVERY" date,
    PRIMARY KEY ("Order_ID")
);

COMMENT ON TABLE public."ORDERS"
    IS 'connects orders with the product ASSOCIATE TABLE';

ALTER TABLE IF EXISTS public."Suppliers"
    ADD FOREIGN KEY ("Orders_ID")
    REFERENCES public."ORDERS" ("Order_ID") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public."Suppliers"
    ADD FOREIGN KEY ("Purchase_ID")
    REFERENCES public."Purchases" ("Purchase_ID") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public."Purchases"
    ADD FOREIGN KEY ("Purchase_ID")
    REFERENCES public."Suppliers" ("Purchase_ID") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public."Purchases"
    ADD FOREIGN KEY ("PRODUCT_ID")
    REFERENCES public."Products" ("PRODUCT_ID") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public."Products"
    ADD FOREIGN KEY ("SUPPLIER_ID")
    REFERENCES public."Suppliers" ("SUPPLIER_ID") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public."ORDERS"
    ADD FOREIGN KEY ("Order_ID")
    REFERENCES public."Products" ("PRODUCT_ID") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public."ORDERS"
    ADD FOREIGN KEY ("SUPPLIER_ID")
    REFERENCES public."Suppliers" ("SUPPLIER_ID") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public."ORDERS"
    ADD FOREIGN KEY ("PRODUCT_ID")
    REFERENCES public."Products" ("PRODUCT_ID") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

END;